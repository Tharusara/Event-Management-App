!function(){function e(e){return function(e){if(Array.isArray(e))return t(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,a){if(!e)return;if("string"==typeof e)return t(e,a);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return t(e,a)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,t,a){return t&&n(e.prototype,t),a&&n(e,a),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{"S+wf":function(t,n,i){"use strict";i.r(n),i.d(n,"RolesModule",(function(){return ee}));var r=i("ofXK"),c=i("tyNb"),s=i("0IaG"),l=i("IOme"),u=i("fXoL"),b=i("Wp6s"),d=i("3Pt+"),m=i("bTqV"),f=i("NFeN"),p=i("bSwM");function h(e,t){if(1&e&&(u.Ub(0,"div",11),u.Ub(1,"mat-checkbox",12),u.fc("change",(function(){var e=t.$implicit;return e.checked=!e.checked})),u.Mc(2),u.Tb(),u.Tb()),2&e){var a=t.$implicit,n=u.jc();u.Bb(1),u.rc("value",a.name),u.qc("checked",a.checked)("disabled","Admin"===a.name&&"Admin"===n.user.userName),u.Bb(1),u.Nc(a.name)}}var g,v,y=((g=function(){function e(t,n){a(this,e),this.dialogRef=t,this.data=n}return o(e,[{key:"ngOnInit",value:function(){this.dialogRef.addPanelClass("custom-dialog"),l.a.isDark()?this.dialogRef.addPanelClass("dark"):this.dialogRef.addPanelClass("light"),this.user=this.data.user,this.roles=this.data.roles}},{key:"updateRoles",value:function(){this.dialogRef.close(this.roles)}}]),e}()).\u0275fac=function(e){return new(e||g)(u.Ob(s.g),u.Ob(s.a))},g.\u0275cmp=u.Ib({type:g,selectors:[["app-roles-form"]],decls:24,vars:4,consts:[[1,"dialog-wrapper"],["mat-dialog-title",""],["mat-dialog-content",""],[1,"message"],["id","rolesForm"],["rolesForm","ngForm"],["class","form-check",4,"ngFor","ngForOf"],["mat-dialog-actions",""],[1,"spacer"],["mat-raised-button","","color","primary","cdkFocusInitial","",3,"mat-dialog-close"],["color","accent","mat-raised-button","",1,"mr-0",3,"click"],[1,"form-check"],[1,"example-margin",3,"value","checked","disabled","change"]],template:function(e,t){1&e&&(u.Ub(0,"div",0),u.Ub(1,"h1",1),u.Mc(2),u.Tb(),u.Ub(3,"mat-card"),u.Ub(4,"div",2),u.Ub(5,"p"),u.Mc(6,"Are you sure you want to Edit \u201c\xa0"),u.Ub(7,"span",3),u.Mc(8),u.Tb(),u.Mc(9,"\xa0\u201ds Roles?"),u.Tb(),u.Tb(),u.Ub(10,"div"),u.Ub(11,"form",4,5),u.Kc(13,h,3,4,"div",6),u.Tb(),u.Tb(),u.Ub(14,"div",7),u.Pb(15,"span",8),u.Ub(16,"button",9),u.Ub(17,"mat-icon"),u.Mc(18,"clear"),u.Tb(),u.Mc(19," No"),u.Tb(),u.Ub(20,"button",10),u.fc("click",(function(){return t.updateRoles()})),u.Ub(21,"mat-icon"),u.Mc(22,"edit"),u.Tb(),u.Mc(23," Yes"),u.Tb(),u.Tb(),u.Tb(),u.Tb()),2&e&&(u.Bb(2),u.Oc("Edit Roles for ",t.user.userName,""),u.Bb(6),u.Nc(t.user.userName),u.Bb(5),u.qc("ngForOf",t.roles),u.Bb(3),u.qc("mat-dialog-close",!1))},directives:[s.h,b.a,s.e,d.w,d.o,d.p,r.l,s.c,m.b,s.d,f.a,p.a],styles:[".message[_ngcontent-%COMP%]{font-weight:500}p[_ngcontent-%COMP%]{font-size:110%}div[mat-dialog-actions][_ngcontent-%COMP%]{margin-bottom:-10px}.dialog-wrapper[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{margin-left:-10px;margin-right:-10px}h1[_ngcontent-%COMP%]{margin-top:-24px;font-size:20px!important;margin-left:-24px!important;margin-right:-24px!important;padding:14px 14px 5px!important;border-bottom:1px solid rgba(0,0,0,.1)}"]}),g),U=i("tk/3"),T=i("AytR"),k=((v=function(){function e(t){a(this,e),this.http=t,this.baseUrl=T.a.ApiUrl}return o(e,[{key:"getUsersWithRoles",value:function(e){var t=new U.d;return null!=e.name&&""!==e.name&&(t=t.set("name",e.name)),null!=e.roles&&""!==e.roles&&(t=t.set("roles",e.roles)),null!=e.id&&""!==e.id&&(t=t.set("id",e.id)),this.http.get(this.baseUrl+"admin/usersWithRoles",{observe:"response",params:t})}},{key:"updateRoles",value:function(e,t){return this.http.post("".concat(this.baseUrl,"admin/editRoles/").concat(e.userName),t)}}]),e}()).\u0275fac=function(e){return new(e||v)(u.cc(U.b))},v.\u0275prov=u.Kb({token:v,factory:v.\u0275fac,providedIn:"root"}),v),w=i("dNgK"),M=i("5VPf"),R=i("Xa2L"),C=i("kmnG"),S=i("qFsG"),B=i("+0xr"),O=i("M9IT"),D=i("yX84");function P(e,t){1&e&&(u.Ub(0,"div",3),u.Pb(1,"mat-spinner"),u.Ub(2,"h1",4),u.Mc(3,"Loading..."),u.Tb(),u.Tb())}function F(e,t){1&e&&(u.Ub(0,"th",26),u.Mc(1,"UserId"),u.Tb())}function I(e,t){if(1&e&&(u.Ub(0,"td",27),u.Mc(1),u.Tb()),2&e){var a=t.$implicit;u.Bb(1),u.Oc("UID",a.id,"")}}function A(e,t){1&e&&(u.Ub(0,"th",26),u.Mc(1,"UserName"),u.Tb())}function x(e,t){if(1&e&&(u.Ub(0,"td",27),u.Mc(1),u.kc(2,"titlecase"),u.Tb()),2&e){var a=t.$implicit;u.Bb(1),u.Oc(" ",u.lc(2,1,a.userName)," ")}}function K(e,t){1&e&&(u.Ub(0,"th",26),u.Mc(1,"Active Roles"),u.Tb())}function j(e,t){if(1&e&&(u.Ub(0,"td",27),u.Mc(1),u.Tb()),2&e){var a=t.$implicit;u.Bb(1),u.Oc(" ",a.roles," ")}}function N(e,t){1&e&&u.Pb(0,"th",28)}function q(e,t){if(1&e){var a=u.Vb();u.Ub(0,"button",31),u.fc("click",(function(){u.Bc(a);var e=u.jc().$implicit;return u.jc(2).editRoleModals(e)})),u.Ub(1,"mat-icon"),u.Mc(2,"edit"),u.Tb(),u.Mc(3," Change Roles "),u.Tb()}}var z=function(){return["Admin","Manager"]};function E(e,t){1&e&&(u.Ub(0,"td",29),u.Kc(1,q,4,0,"button",30),u.Tb()),2&e&&(u.Bb(1),u.qc("appHasRole",u.tc(1,z)))}function L(e,t){1&e&&u.Pb(0,"tr",32)}function $(e,t){1&e&&u.Pb(0,"tr",33)}var _=function(){return[5,10,25,50,100]};function H(e,t){if(1&e){var a=u.Vb();u.Ub(0,"div",5),u.Ub(1,"mat-card"),u.Ub(2,"mat-card-content"),u.Ub(3,"div",6),u.Ub(4,"div",7),u.Ub(5,"div",8),u.Ub(6,"mat-form-field",9),u.Ub(7,"mat-label"),u.Mc(8,"Filter by ID"),u.Tb(),u.Ub(9,"input",10),u.fc("keyup",(function(){return u.Bc(a),u.jc().loadData()})),u.Tb(),u.Tb(),u.Tb(),u.Pb(10,"span",11),u.Ub(11,"div",8),u.Ub(12,"mat-form-field",9),u.Ub(13,"mat-label"),u.Mc(14,"Filter by Name"),u.Tb(),u.Ub(15,"input",10),u.fc("keyup",(function(){return u.Bc(a),u.jc().loadData()})),u.Tb(),u.Tb(),u.Tb(),u.Tb(),u.Tb(),u.Ub(16,"div",12),u.Ub(17,"table",13),u.Sb(18,14),u.Kc(19,F,2,0,"th",15),u.Kc(20,I,2,1,"td",16),u.Rb(),u.Sb(21,17),u.Kc(22,A,2,0,"th",15),u.Kc(23,x,3,3,"td",16),u.Rb(),u.Sb(24,18),u.Kc(25,K,2,0,"th",15),u.Kc(26,j,2,1,"td",16),u.Rb(),u.Sb(27,19),u.Kc(28,N,1,0,"th",20),u.Kc(29,E,2,2,"td",21),u.Rb(),u.Kc(30,L,1,0,"tr",22),u.Kc(31,$,1,0,"tr",23),u.Tb(),u.Tb(),u.Ub(32,"div",24),u.Ub(33,"mat-paginator",25),u.fc("page",(function(e){return u.Bc(a),u.jc().paginate(e)})),u.Tb(),u.Tb(),u.Tb(),u.Tb(),u.Tb()}if(2&e){var n=u.jc();u.Bb(9),u.qc("formControl",n.codeField),u.Bb(6),u.qc("formControl",n.nameField),u.Bb(2),u.qc("dataSource",n.users),u.Bb(13),u.qc("matHeaderRowDef",n.displayedColumns),u.Bb(1),u.qc("matRowDefColumns",n.displayedColumns),u.Bb(2),u.qc("length",n.users.length)("pageSize",10)("pageSizeOptions",u.tc(9,_))("showFirstLastButtons",!0)}}var X,V,W,G=function(){return["Users","Show All Roles"]},J=[{path:"",component:(X=function(){function t(e,n,o){a(this,t),this.roles=e,this.dialog=n,this.snackBar=o,this.displayedColumns=["userid","username","roles","update-col"],this.Roles=["Admin","Manager","Supervisor","Employee"],this.userParams={},this.pageSize=10,this.pageIndex=1,this.live=!1,this.codeField=new d.e,this.nameField=new d.e,this.roleField=new d.e}return o(t,[{key:"ngOnInit",value:function(){this.loadingState=!0,this.live=!0,this.loadData()}},{key:"paginate",value:function(e){this.pagination.currentPage=e.pageIndex,this.pageSize=e.pageSize,this.pageIndex=e.pageIndex+1,this.loadData()}},{key:"ngOnDestroy",value:function(){this.loadData(),this.live=!0,this.refreshData()}},{key:"refreshData",value:function(){this.loadData()}},{key:"loadData",value:function(){var e=this;this.userParams.name=this.nameField.value,this.userParams.id=this.codeField.value,this.userParams.roles=this.roleField.value,this.roles.getUsersWithRoles(this.userParams).subscribe((function(t){e.loadingState=!1,e.users=t.body}),(function(t){switch(console.log(t),t.status){case 401:case 403:e.snackBar.open("Authorization Failed.","Access denied!",{duration:3e3}),setTimeout((function(){}),500);break;default:e.snackBar.open("there is a problem loading roles\u2757","\u274c",{duration:3e3})}}))}},{key:"editRoleModals",value:function(t){var a=this;this.dialog.open(y,{width:"500px",data:{user:t,roles:this.getRolesArray(t)}}).afterClosed().subscribe((function(n){if(n){a.loadingState=!0;var o={roleNames:e(n.filter((function(e){return!0===e.checked})).map((function(e){return e.name})))};o&&a.roles.updateRoles(t,o).subscribe((function(){t.roles=e(o.roleNames),a.snackBar.open("Roles Edited successfully","\u2714",{duration:2e3}),a.loadData()}),(function(e){console.log(e),a.snackBar.open("Failed to edit Roles\u2757 someting went wrong","\u274c",{duration:2e3}),a.loadingState=!1}))}}))}},{key:"getRolesArray",value:function(e){for(var t=[],a=e.roles,n=[{name:"Admin",value:"Admin"},{name:"Manager",value:"Manager"},{name:"Supervisor",value:"Supervisor"},{name:"Employee",value:"Employee"}],o=0;o<n.length;o++){for(var i=!1,r=0;r<a.length;r++)if(n[o].name===a[r]){i=!0,n[o].checked=!0,t.push(n[o]);break}i||(n[o].checked=!1,t.push(n[o]))}return t}}]),t}(),X.\u0275fac=function(e){return new(e||X)(u.Ob(k),u.Ob(s.b),u.Ob(w.a))},X.\u0275cmp=u.Ib({type:X,selectors:[["app-roles-table"]],decls:4,vars:4,consts:[["title","Roles",3,"breadcrumbSegments"],["class","spinner",4,"ngIf","ngIfElse"],["userlist",""],[1,"spinner"],[1,"mat-h1","mt-3"],[1,"mat-elevation-z8"],[1,"mb-1"],[1,"row"],[1,"col-md-12","col-lg-6"],["appearance","outline",1,"w-100","search-form-field"],["matInput","",3,"formControl","keyup"],[1,"spacer"],[1,"table-responsive","table-striped"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","userid"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","username"],["matColumnDef","roles"],["matColumnDef","update-col"],["class","btn-col","mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","class","btn-col",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[1,"mt-1"],[3,"length","pageSize","pageSizeOptions","showFirstLastButtons","page"],["mat-header-cell",""],["mat-cell",""],["mat-header-cell","",1,"btn-col"],["mat-cell","",1,"btn-col"],["class","mat-btn-sm","mat-raised-button","","color","accent",3,"click",4,"appHasRole"],["mat-raised-button","","color","accent",1,"mat-btn-sm",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(e,t){if(1&e&&(u.Pb(0,"app-page-header",0),u.Kc(1,P,4,0,"div",1),u.Kc(2,H,34,10,"ng-template",null,2,u.Lc)),2&e){var a=u.yc(3);u.qc("breadcrumbSegments",u.tc(3,G)),u.Bb(1),u.qc("ngIf",t.loadingState)("ngIfElse",a)}},directives:[M.a,r.m,R.b,b.a,b.c,C.c,C.g,S.b,d.c,d.n,d.f,B.j,B.c,B.e,B.b,B.g,B.i,O.a,B.d,B.a,D.a,m.b,f.a,B.f,B.h],pipes:[r.v],styles:[".spinner[_ngcontent-%COMP%]{top:45%;left:47%;position:absolute}"]}),X)},{path:"add",component:y}],Y=((V=function e(){a(this,e)}).\u0275mod=u.Mb({type:V}),V.\u0275inj=u.Lb({factory:function(e){return new(e||V)},imports:[[c.g.forChild(J)],c.g]}),V),Q=i("hctd"),Z=i("FpXt"),ee=((W=function e(){a(this,e)}).\u0275mod=u.Mb({type:W}),W.\u0275inj=u.Lb({factory:function(e){return new(e||W)},imports:[[r.c,Y,Q.a,d.s,d.j,Z.a]]}),W)}}])}();